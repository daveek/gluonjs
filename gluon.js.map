{"version":3,"file":"gluon.js","sources":["src/gluon.js"],"sourcesContent":["import { render } from '../lit-html/lib/lit-extended.js';\nexport { html } from '../lit-html/lib/lit-extended.js';\n\nconst TAG = Symbol('tag');\nconst NEEDSRENDER = Symbol('needsRender');\nconst SHADYTEMPLATE = Symbol('shadyTemplate');\n\nconst applyShadyCSS = element => {\n  if (window.ShadyCSS) {\n    const klass = element.constructor;\n    if (klass[SHADYTEMPLATE] === undefined) {\n      klass[SHADYTEMPLATE] = document.createElement('template');\n      klass[SHADYTEMPLATE].innerHTML = element.shadowRoot.innerHTML;\n      ShadyCSS.prepareTemplate(klass[SHADYTEMPLATE], klass.is);\n    }\n    ShadyCSS.styleElement(element);\n  }\n};\n\nconst camelToKebab = camel => camel.replace(/([a-z])([A-Z])|(.)([A-Z][a-z])/g, '$1$3-$2$4').toLowerCase();\n\nconst createIdCache = element => {\n  element.$ = {};\n  element.shadowRoot.querySelectorAll('[id]').forEach(el => {\n    element.$[el.id] = el;\n  });\n};\n\nexport class GluonElement extends HTMLElement {\n  static get is() {\n    return (this.hasOwnProperty(TAG) && this[TAG]) || (this[TAG] = camelToKebab(this.name));\n  }\n  connectedCallback() {\n    if ('template' in this) {\n      this.attachShadow({ mode: 'open' });\n      this.render({ sync: true });\n      createIdCache(this);\n    }\n  }\n  // Render the element's template.\n  // By default, renders are asynchronous and executed at the next microtask timing,\n  // so multiple render calls are batched.\n  // If the sync option is set to `true`, it renders synchronously instead.\n  // Returns a Promise that resolves when the render is completed.\n  async render({ sync = false } = {}) {\n    this[NEEDSRENDER] = true;\n    if (!sync) {\n      await 0;\n    }\n    if (this[NEEDSRENDER]) {\n      this[NEEDSRENDER] = false;\n      render(this.template, this.shadowRoot);\n      applyShadyCSS(this);\n    }\n  }\n}\n"],"names":["TAG","Symbol","NEEDSRENDER","SHADYTEMPLATE","applyShadyCSS","element","window","ShadyCSS","klass","constructor","undefined","document","createElement","innerHTML","shadowRoot","prepareTemplate","is","styleElement","camelToKebab","camel","replace","toLowerCase","createIdCache","$","querySelectorAll","forEach","el","id","GluonElement","HTMLElement","this","hasOwnProperty","name","[object Object]","attachShadow","mode","render","sync","template"],"mappings":"2GAGA,MAAMA,EAAMC,OAAO,OACbC,EAAcD,OAAO,eACrBE,EAAgBF,OAAO,iBAEvBG,EAAgBC,IACpB,GAAIC,OAAOC,SAAU,CACnB,MAAMC,EAAQH,EAAQI,iBACOC,IAAzBF,EAAML,KACRK,EAAML,GAAiBQ,SAASC,cAAc,YAC9CJ,EAAML,GAAeU,UAAYR,EAAQS,WAAWD,UACpDN,SAASQ,gBAAgBP,EAAML,GAAgBK,EAAMQ,KAEvDT,SAASU,aAAaZ,KAIpBa,EAAeC,GAASA,EAAMC,QAAQ,kCAAmC,aAAaC,cAEtFC,EAAgBjB,IACpBA,EAAQkB,KACRlB,EAAQS,WAAWU,iBAAiB,QAAQC,QAAQC,IAClDrB,EAAQkB,EAAEG,EAAGC,IAAMD,WAIVE,UAAqBC,YAChCb,gBACE,OAAQc,KAAKC,eAAe/B,IAAQ8B,KAAK9B,KAAU8B,KAAK9B,GAAOkB,EAAaY,KAAKE,OAEnFC,oBACM,aAAcH,OAChBA,KAAKI,cAAeC,KAAM,SAC1BL,KAAKM,QAASC,MAAM,IACpBf,EAAcQ,OAQlBG,cAAaI,KAAEA,GAAO,OACpBP,KAAK5B,IAAe,EACfmC,SACG,EAEJP,KAAK5B,KACP4B,KAAK5B,IAAe,EACpBkC,EAAON,KAAKQ,SAAUR,KAAKhB,YAC3BV,EAAc0B"}